version 0.1
namespace vulnerability

import rbac

// organization-wide assets
@rbac.add_v1_based_permission(app:'vulnerability', resource:'toggle_cves_without_errata', verb:'write', v2_perm:'vulnerability_toggle_cves_without_errata_edit');
@rbac.add_v1_based_permission(app:'vulnerability', resource:'cve_business_risk_and_status', verb:'write', v2_perm:'vulnerability_cve_business_risk_and_status_edit');

// host-centric assets
@rbac.add_v1_based_permission(app:'vulnerability', resource:'vulnerability_results', verb:'read', v2_perm:'vulnerability_vulnerability_results_view_assigned');
@rbac.add_contingent_permission(first: 'inventory_host_view', second: 'vulnerability_vulnerability_results_view_assigned', contingent: 'vulnerability_vulnerability_results_view');

@rbac.add_v1_based_permission(app:'vulnerability', resource:'system_cve_status', verb:'write', v2_perm:'vulnerability_system_cve_status_edit_assigned');
@rbac.add_contingent_permission(first: 'inventory_host_view', second: 'vulnerability_system_cve_status_edit_assigned', contingent: 'vulnerability_system_cve_status_edit');

@rbac.add_v1_based_permission(app:'vulnerability', resource:'system_opt_out', verb:'read', v2_perm:'vulnerability_system_opt_out_view_assigned');
@rbac.add_contingent_permission(first: 'inventory_host_view', second: 'vulnerability_system_opt_out_view_assigned', contingent: 'vulnerability_system_opt_out_view');

@rbac.add_v1_based_permission(app:'vulnerability', resource:'system_opt_out', verb:'write', v2_perm:'vulnerability_system_opt_out_edit_assigned');
@rbac.add_contingent_permission(first: 'inventory_host_view', second: 'vulnerability_system_opt_out_edit_assigned', contingent: 'vulnerability_system_opt_out_edit');

@rbac.add_v1_based_permission(app:'vulnerability', resource:'advanced_report', verb:'read', v2_perm:'vulnerability_advanced_report_view_assigned');
@rbac.add_contingent_permission(first: 'inventory_host_view', second: 'vulnerability_advanced_report_view_assigned', contingent: 'vulnerability_advanced_report_view');

@rbac.add_v1_based_permission(app:'vulnerability', resource:'report_and_export', verb:'read', v2_perm:'vulnerability_report_and_export_view_assigned');
@rbac.add_contingent_permission(first: 'inventory_host_view', second: 'vulnerability_report_and_export_view_assigned', contingent: 'vulnerability_report_and_export_view');
