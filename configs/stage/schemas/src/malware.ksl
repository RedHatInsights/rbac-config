version 0.1
namespace malware

import rbac

// The permission malware_detection:malware:read does not really exist, but we're going to have the permission malware-detection:*:read
@rbac.add_v1_based_permission(app:'malware_detection', resource:'malware', verb:'read', v2_perm:'malware_malware_view_assigned');
@rbac.add_contingent_permission(first:'inventory_host_view', second:'malware_malware_view_assigned', contingent:'malware_malware_view');

// malware-detection:acknowledgements:write
@rbac.add_v1_based_permission(app:'malware_detection', resource:'acknowledgements', verb:'write', v2_perm:'malware_malware_acknowledge_assigned');
@rbac.add_contingent_permission(first:'inventory_host_view', second:'malware_malware_acknowledge_assigned', contingent:'malware_malware_acknowledge');

// The permission malware_detection:malware:write does not really exist, but we're going to have the permission malware-detection:*:write
@rbac.add_v1_based_permission(app:'malware_detection', resource:'malware', verb:'write', v2_perm:'malware_malware_edit_assigned');
@rbac.add_contingent_permission(first:'inventory_host_view', second:'malware_malware_edit_assigned', contingent:'malware_malware_edit');
